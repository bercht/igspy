<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-semibold text-white mb-2">
      Seu Contexto de Perfil
    </h1>
    <p class="text-gray-400">
      InformaÃ§Ãµes extraÃ­das automaticamente para personalizar seus agentes de conteÃºdo
    </p>
  </div>
  
  <!-- Status Badge -->
  <% if @context.processing? %>
    <div class="mb-6 bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4">
      <div class="flex items-center space-x-3">
        <div class="animate-spin rounded-full h-5 w-5 border-2 border-yellow-500 border-t-transparent"></div>
        <span class="text-yellow-300">Analisando seu perfil...</span>
      </div>
    </div>
  <% elsif @context.failed? %>
    <div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-4">
      <span class="text-red-300">Erro na anÃ¡lise. Tente reanalisar.</span>
    </div>
  <% end %>
  
  <%= form_with model: @context, url: admin_profile_context_path, method: :patch, class: "space-y-8" do |f| %>
    
    <!-- Nicho -->
    <div class="bg-white/[0.02] backdrop-blur-sm rounded-2xl p-6 border border-white/[0.05]">
      <%= f.label :detected_niche, "ğŸ“Š Nicho Detectado", class: "block text-sm font-medium text-gray-300 mb-3" %>
      <%= f.text_field :detected_niche, 
          class: "w-full px-4 py-3 bg-white/[0.03] border border-white/[0.05] rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-[#0A7AFF]/50 focus:ring-1 focus:ring-[#0A7AFF]/50 transition-all",
          placeholder: "Ex: EstÃ©tica AvanÃ§ada" %>
    </div>
    
    <!-- PÃºblico-Alvo -->
    <div class="bg-white/[0.02] backdrop-blur-sm rounded-2xl p-6 border border-white/[0.05]">
      <%= f.label :detected_audience, "ğŸ‘¥ PÃºblico-Alvo", class: "block text-sm font-medium text-gray-300 mb-3" %>
      <%= f.text_area :detected_audience, 
          rows: 3,
          class: "w-full px-4 py-3 bg-white/[0.03] border border-white/[0.05] rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-[#0A7AFF]/50 focus:ring-1 focus:ring-[#0A7AFF]/50 transition-all",
          placeholder: "Descreva seu pÃºblico ideal..." %>
    </div>
    
    <!-- Tom de ComunicaÃ§Ã£o -->
    <div class="bg-white/[0.02] backdrop-blur-sm rounded-2xl p-6 border border-white/[0.05]">
      <label class="block text-sm font-medium text-gray-300 mb-3">ğŸ¤ Tom de ComunicaÃ§Ã£o</label>
      <div class="flex flex-wrap gap-3">
        <% UserProfileContext.communication_tones.keys.each do |tone| %>
          <label class="flex items-center space-x-2 px-4 py-2 bg-white/[0.03] rounded-lg border border-white/[0.05] cursor-pointer hover:border-[#0A7AFF]/50 transition">
            <%= f.radio_button :communication_tone, tone, class: "text-[#0A7AFF]" %>
            <span class="text-white capitalize"><%= tone.humanize %></span>
          </label>
        <% end %>
      </div>
    </div>
    
    <!-- Temas Frequentes -->
    <div class="bg-white/[0.02] backdrop-blur-sm rounded-2xl p-6 border border-white/[0.05]">
      <%= f.label :frequent_themes, "ğŸ·ï¸ Temas Frequentes", class: "block text-sm font-medium text-gray-300 mb-3" %>
      <div class="flex flex-wrap gap-2 mb-3">
        <% (@context.frequent_themes || []).each do |theme| %>
          <span class="px-3 py-1 bg-[#0A7AFF]/10 text-[#0A7AFF] rounded-full text-sm">
            <%= theme %>
          </span>
        <% end %>
      </div>
      <p class="text-xs text-gray-500">Edite no campo "CorreÃ§Ãµes" abaixo para adicionar/remover temas</p>
    </div>
    
    <!-- AnÃ¡lise Completa -->
    <% if @context.full_analysis.present? %>
      <div class="bg-white/[0.02] backdrop-blur-sm rounded-2xl p-6 border border-white/[0.05]">
        <h3 class="text-sm font-medium text-gray-300 mb-3">ğŸ“ AnÃ¡lise Completa</h3>
        <p class="text-gray-400 leading-relaxed"><%= @context.full_analysis %></p>
      </div>
    <% end %>
    
    <!-- CorreÃ§Ãµes Manuais -->
    <div class="bg-white/[0.02] backdrop-blur-sm rounded-2xl p-6 border border-white/[0.05]">
      <%= f.label :user_corrections, "âœï¸ Suas CorreÃ§Ãµes/ObservaÃ§Ãµes", class: "block text-sm font-medium text-gray-300 mb-3" %>
      <%= f.text_area :user_corrections, 
          rows: 4,
          class: "w-full px-4 py-3 bg-white/[0.03] border border-white/[0.05] rounded-xl text-white placeholder-gray-600 focus:outline-none focus:border-[#0A7AFF]/50 focus:ring-1 focus:ring-[#0A7AFF]/50 transition-all",
          placeholder: "Adicione informaÃ§Ãµes que a IA nÃ£o captou ou corrija algo..." %>
    </div>
    
    <!-- Actions -->
    <div class="flex items-center justify-between">
      <%= button_to reanalyze_admin_profile_context_path, method: :post, class: "px-6 py-3 rounded-xl font-medium text-white bg-white/[0.05] border border-white/[0.10] hover:bg-white/[0.08] transition" do %>
        ğŸ”„ Reanalisar Perfil
      <% end %>
      
      <%= f.submit "ğŸ’¾ Salvar AlteraÃ§Ãµes", 
          class: "px-8 py-3 rounded-xl font-medium text-white transition-all duration-300 hover:scale-105 shadow-lg cursor-pointer",
          style: "background: linear-gradient(135deg, #0A7AFF 0%, #3B9EFF 100%);" %>
    </div>
    
  <% end %>
  
</div>
